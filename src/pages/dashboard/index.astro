---
export const prerender = false;

const user = Astro.locals.user;
const session = Astro.locals.session;

import { validateSessionToken } from "@/lib/server/sessions";

if (session === null) {
  return Astro.redirect("/login");
}

const validSession = await validateSessionToken(session?.id);

if (!validSession) {
  return Astro.redirect("/login");
}

if (!user?.admin) {
  return Astro.redirect("/");
}

import Layout from "@/layouts/Layout.astro";
import Section from "@/components/Section.astro";

import { db, eq, Orders } from "astro:db";
---

<Layout title="Dashboard" description="Dashboard" showCart={false}>
  <Section>
    <h1 class="text-2xl font-medium tracking-tight ~mt-4/16 ~mb-2/8">
      Bienvenid@ {user?.nombre}
    </h1>
    <div></div>
  </Section>
</Layout>
